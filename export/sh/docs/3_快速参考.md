# Docker Export Compose - å¿«é€Ÿå‚è€ƒå¡ç‰‡ / Quick Reference Card

## ğŸš€ ä¸€åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

```bash
# 1. åŸºç¡€å¯¼å‡ºï¼ˆä»…é™æœ¬åœ°å¼€å‘ï¼‰
./docker-export-compose.sh my-container

# 2. ç”Ÿäº§ç¯å¢ƒï¼ˆæ¨èï¼‰â­
./docker-export-compose.sh --type env --privacy my-container

# 3. æ‰¹é‡å¯¼å‡º
./docker-export-compose.sh --all-run --type env -o ~/backup
```

---

## ğŸ“‹ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### åŸºç¡€å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `./docker-export-compose.sh <å®¹å™¨å>` | å¯¼å‡ºå•ä¸ªå®¹å™¨ |
| `./docker-export-compose.sh --all-run` | å¯¼å‡ºæ‰€æœ‰è¿è¡Œä¸­å®¹å™¨ |
| `./docker-export-compose.sh --file list.txt` | ä»æ–‡ä»¶æ‰¹é‡å¯¼å‡º |
| `./docker-export-compose.sh --help-cn` | æŸ¥çœ‹ä¸­æ–‡å¸®åŠ© |
| `./docker-export-compose.sh --version` | æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ |

### v2.2 å®‰å…¨é€‰é¡¹ â­

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| `--privacy` | éšè—ä¸»æœºè·¯å¾„ï¼ˆåˆ†äº«æ—¶ä½¿ç”¨ï¼‰ |
| `--type env` | env æ¨¡å¼ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰ |
| `--must-output` | å¼ºåˆ¶è¾“å‡ºåˆ°æ ¸å¿ƒç›®å½•ï¼ˆå±é™©ï¼ï¼‰ |
| `-o <ç›®å½•>` | æŒ‡å®šè¾“å‡ºç›®å½•ï¼ˆé»˜è®¤ï¼š./outputï¼‰ |

### ç»„åˆä½¿ç”¨

```bash
# æœ€å®‰å…¨çš„å¯¼å‡ºæ–¹å¼
./docker-export-compose.sh --type env --privacy my-app

# æ‰¹é‡å®‰å…¨å¯¼å‡º
./docker-export-compose.sh --all-run --type env --privacy -o ~/backup

# é¢„è§ˆä¸æ‰§è¡Œ
./docker-export-compose.sh --dry-run my-app
```

---

## ğŸ¯ æ ¹æ®åœºæ™¯é€‰æ‹©

### åœºæ™¯ 1ï¼šæœ¬åœ°å¼€å‘æµ‹è¯•

```bash
./docker-export-compose.sh my-dev-app
cd output/my-dev-app
docker compose up -d
```

**ç‰¹ç‚¹**ï¼šå¿«é€Ÿï¼Œä½†åŒ…å«æ˜æ–‡æ•æ„Ÿä¿¡æ¯  
**âš ï¸ æ³¨æ„**ï¼šä¸è¦æäº¤åˆ° Gitï¼Œä¸è¦åˆ†äº«ç»™ä»–äºº

### åœºæ™¯ 2ï¼šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
./docker-export-compose.sh --type env --privacy my-prod-app
cd output/my-prod-app
docker compose config  # éªŒè¯
docker compose up -d
```

**ç‰¹ç‚¹**ï¼šæœ€å®‰å…¨ï¼Œæ•æ„Ÿä¿¡æ¯åˆ†ç¦»  
**âœ… æ¨è**ï¼šenv æ¨¡å¼ + éšç§æ¨¡å¼

### åœºæ™¯ 3ï¼šåˆ†äº«é…ç½®ç»™å›¢é˜Ÿ

```bash
./docker-export-compose.sh --type env --privacy shared-app
cd output/shared-app

# åªåˆ†äº«è¿™äº›æ–‡ä»¶ï¼š
git add docker-compose.yml .env.example README.md .gitignore
git commit -m "Add config"
# .env ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ï¼ˆåŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰
```

**ç‰¹ç‚¹**ï¼šå®‰å…¨åˆ†äº«ï¼Œå›¢é˜Ÿæˆå‘˜å¡«å†™è‡ªå·±çš„ .env

### åœºæ™¯ 4ï¼šæ‰¹é‡å¤‡ä»½

```bash
./docker-export-compose.sh --all-run --type env -o ~/docker-backup
tar -czf backup-$(date +%Y%m%d).tar.gz ~/docker-backup
```

**ç‰¹ç‚¹**ï¼šå®Œæ•´å¤‡ä»½æ‰€æœ‰å®¹å™¨é…ç½®

---

## âš ï¸ å®‰å…¨è­¦å‘Šé€ŸæŸ¥

### âŒ ä¸å®‰å…¨çš„åšæ³•

```bash
# âŒ yml æ¨¡å¼æäº¤åˆ° Gitï¼ˆæ³„éœ²å¯†ç ï¼‰
./docker-export-compose.sh my-app
git add output/my-app/docker-compose.yml  # åŒ…å«æ˜æ–‡å¯†ç ï¼

# âŒ åˆ†äº« .env æ–‡ä»¶ï¼ˆæ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼‰
scp output/my-app/.env user@server:/tmp/  # å±é™©ï¼

# âŒ è¾“å‡ºåˆ°ç³»ç»Ÿç›®å½•ï¼ˆç ´åç³»ç»Ÿï¼‰
./docker-export-compose.sh -o /etc my-app  # ä¼šè¢«æ‹¦æˆª
```

### âœ… å®‰å…¨çš„åšæ³•

```bash
# âœ… env æ¨¡å¼æäº¤åˆ° Gitï¼ˆå®‰å…¨ï¼‰
./docker-export-compose.sh --type env --privacy my-app
git add output/my-app/docker-compose.yml  # ä½¿ç”¨ ${VAR} å¼•ç”¨
git add output/my-app/.env.example  # å®‰å…¨æ¨¡æ¿
# .env ä¼šè¢«è‡ªåŠ¨å¿½ç•¥

# âœ… åªåˆ†äº«æ¨¡æ¿ï¼ˆå®‰å…¨ï¼‰
scp output/my-app/.env.example user@server:/tmp/
scp output/my-app/docker-compose.yml user@server:/tmp/

# âœ… è¾“å‡ºåˆ°å®‰å…¨ç›®å½•
./docker-export-compose.sh -o ~/exports my-app  # å®‰å…¨
```

---

## ğŸ” è¾“å‡ºæ–‡ä»¶è¯´æ˜

### yml æ¨¡å¼è¾“å‡º

```
./output/
â””â”€â”€ my-container/
    â””â”€â”€ docker-compose.yml  âš ï¸ åŒ…å«æ˜æ–‡æ•æ„Ÿä¿¡æ¯
```

### env æ¨¡å¼è¾“å‡º â­

```
./output/
â””â”€â”€ my-container/
    â”œâ”€â”€ docker-compose.yml  âœ… ä½¿ç”¨ ${VAR} å¼•ç”¨
    â”œâ”€â”€ .env                âš ï¸ å®é™…æ•æ„Ÿæ•°æ®ï¼ˆå·²åŠ å…¥ .gitignoreï¼‰
    â”œâ”€â”€ .env.example        âœ… å®‰å…¨æ¨¡æ¿ï¼ˆå¯åˆ†äº«ï¼‰
    â”œâ”€â”€ .gitignore          âœ… è‡ªåŠ¨ç”Ÿæˆ
    â””â”€â”€ README.md           ğŸ“š ä½¿ç”¨è¯´æ˜
```

---

## ğŸš¨ æ•…éšœé€ŸæŸ¥

### é—®é¢˜ï¼šå®¹å™¨åè¢«æ‹’ç»

```bash
[ERROR] å®¹å™¨ååŒ…å«éæ³•å­—ç¬¦ï¼ˆè·¯å¾„éå†æ”»å‡»ï¼‰
```

**åŸå› **ï¼šå®¹å™¨ååŒ…å« `../` æˆ–å…¶ä»–å±é™©å­—ç¬¦  
**è§£å†³**ï¼šä½¿ç”¨ `docker ps` æŸ¥çœ‹æ­£ç¡®çš„å®¹å™¨å

### é—®é¢˜ï¼šè¾“å‡ºè¢«æ‹¦æˆª

```bash
[ERROR] ç¦æ­¢è¾“å‡ºåˆ°æ ¸å¿ƒç³»ç»Ÿç›®å½•ï¼
```

**åŸå› **ï¼šå°è¯•è¾“å‡ºåˆ° /etc, /bin ç­‰ç³»ç»Ÿç›®å½•  
**è§£å†³**ï¼šä½¿ç”¨å®‰å…¨ç›®å½•ï¼ˆå¦‚ ~/exports æˆ–é»˜è®¤çš„ ./outputï¼‰

### é—®é¢˜ï¼šä¸­æ–‡ä¹±ç 

**åŸå› **ï¼šç»ˆç«¯ç¼–ç ä¸æ˜¯ UTF-8  
**è§£å†³**ï¼šv2.2 å·²è‡ªåŠ¨è®¾ç½® UTF-8ï¼Œå¦‚ä»æœ‰é—®é¢˜ï¼š

```bash
export LANG=C.UTF-8
export LC_ALL=C.UTF-8
```

### é—®é¢˜ï¼š.env æ–‡ä»¶æ— æ³•åŠ è½½

**åŸå› **ï¼š.env æ–‡ä»¶æ ¼å¼æˆ–ä½ç½®é”™è¯¯  
**è§£å†³**ï¼š

```bash
# æ£€æŸ¥æ–‡ä»¶ä½ç½®ï¼ˆåº”è¯¥åœ¨ docker-compose.yml åŒçº§ï¼‰
ls -la .env

# éªŒè¯é…ç½®
docker compose config
```

---

## ğŸ“Š ç‰ˆæœ¬å¯¹æ¯”é€ŸæŸ¥

| ç‰¹æ€§ | v2.1 | v2.2 |
|------|------|------|
| éšç§æ¨¡å¼ | âŒ | âœ… |
| æ ¸å¿ƒç›®å½•ä¿æŠ¤ | âŒ | âœ… |
| å®¹å™¨åéªŒè¯ | âŒ | âœ… |
| UTF-8 ç¼–ç  | âŒ | âœ… |
| æ•æ„Ÿè¯æ£€æµ‹ | 13 ä¸ª | 50+ ä¸ª |
| é»˜è®¤ç›®å½• | `.` | `./output` |
| env æ¨¡å¼ | env_file | `${VAR}` |
| yml è­¦å‘Š | âŒ | âœ… |

---

## ğŸ’¡ æœ€ä½³å®è·µé€ŸæŸ¥

### å¼€å‘ç¯å¢ƒ

```bash
./docker-export-compose.sh my-dev-app
```

âœ“ å¿«é€Ÿ  
âœ— åŒ…å«æ˜æ–‡å¯†ç   
âœ— ä¸è¦æäº¤ Git

### ç”Ÿäº§ç¯å¢ƒ

```bash
./docker-export-compose.sh --type env --privacy my-prod-app
```

âœ“ æœ€å®‰å…¨  
âœ“ æ•æ„Ÿä¿¡æ¯åˆ†ç¦»  
âœ“ å¯ä»¥æäº¤ Git

### åˆ†äº«/å¤‡ä»½

```bash
./docker-export-compose.sh --all-run --type env --privacy -o ~/backup
```

âœ“ å®Œæ•´å¤‡ä»½  
âœ“ å®‰å…¨åˆ†äº«  
âœ“ éšè—è·¯å¾„

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [SECURITY_GUIDE.md](SECURITY_GUIDE.md) | å®Œæ•´å®‰å…¨æŒ‡å—ï¼ˆå¿…è¯»ï¼‰ |
| [CHANGELOG_v2.2.md](CHANGELOG_v2.2.md) | è¯¦ç»†æ›´æ–°æ—¥å¿— |
| [README.md](README.md) | å®Œæ•´ä½¿ç”¨æ–‡æ¡£ |

---

## ğŸ“ è·å–å¸®åŠ©

```bash
# ä¸­æ–‡å¸®åŠ©
./docker-export-compose.sh --help-cn

# è‹±æ–‡å¸®åŠ©
./docker-export-compose.sh --help

# ç‰ˆæœ¬ä¿¡æ¯ï¼ˆåŒ…å« v2.2 æ–°ç‰¹æ€§åˆ—è¡¨ï¼‰
./docker-export-compose.sh --version
```

---

**ç‰ˆæœ¬**: v2.2  
**æ›´æ–°**: 2025-11-06  
**ä½œè€…**: clearlove.ymg  
**è®¸å¯è¯**: MIT License

---

## ğŸ¯ è®°ä½è¿™äº›å°±å¤Ÿäº†ï¼

1. **å¼€å‘ç¯å¢ƒ**ï¼š`./docker-export-compose.sh <å®¹å™¨å>`
2. **ç”Ÿäº§ç¯å¢ƒ**ï¼š`./docker-export-compose.sh --type env --privacy <å®¹å™¨å>` â­
3. **æ‰¹é‡å¤‡ä»½**ï¼š`./docker-export-compose.sh --all-run --type env -o ~/backup`
4. **é‡åˆ°é—®é¢˜**ï¼šå…ˆçœ‹ [SECURITY_GUIDE.md](SECURITY_GUIDE.md)

**å®‰å…¨æç¤º**ï¼šç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä½¿ç”¨ `--type env --privacy` ç»„åˆï¼

